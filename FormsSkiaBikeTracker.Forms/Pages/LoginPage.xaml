<?xml version="1.0" encoding="utf-8"?>

<mvx:MvxContentPage x:TypeArguments="viewModels:LoginViewModel"
                     xmlns="http://xamarin.com/schemas/2014/forms"
                     xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                     xmlns:viewModels="clr-namespace:FormsSkiaBikeTracker.Shared.ViewModels;assembly=FormsSkiaBikeTracker.Shared"
                     xmlns:lrpForms="clr-namespace:LRPFramework.Views.Forms.Markup;assembly=LRPFramework.Views.Forms"
                     xmlns:lrpViews="clr-namespace:LRPFramework.Views.Forms;assembly=LRPFramework.Views.Forms"
                     xmlns:lrpMvxForms="clr-namespace:LRPFramework.Mvx.Views.Forms.Markup;assembly=LRPFramework.Mvx.Views.Forms"
                     xmlns:mvx="clr-namespace:MvvmCross.Forms.Views;assembly=MvvmCross.Forms"
                     xmlns:controls="clr-namespace:FormsSkiaBikeTracker.Forms.Controls;assembly=FormsSkiaBikeTracker.Forms"
                     xmlns:effects="clr-namespace:FormsSkiaBikeTracker.Forms.UI.Effects;assembly=FormsSkiaBikeTracker.Forms"
                     x:Class="FormsSkiaBikeTracker.Forms.Pages.LoginPage"
                     x:Name="LoginPageRoot"
                     Title="{lrpForms:LocalizedText Login}"
                     NavigationPage.BackButtonTitle="{lrpForms:LocalizedText Cancel}"
                     NavigationPage.HasNavigationBar="False">

    <Grid RowSpacing="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="140" />
            <RowDefinition Height="2" />
            <RowDefinition Height="*" />
            <RowDefinition Height="2" />
            <RowDefinition Height="120" />
        </Grid.RowDefinitions>

        <lrpViews:SvgImage Grid.Row="0" 
                            Margin="40, 50, 40, 40"
                            HeightRequest="100"
                            WidthRequest="300"
                            HorizontalOptions="Center"
                            VerticalOptions="Fill"
                            Aspect="AspectFit"
                            Source="{lrpMvxForms:EmbeddedImage full_logo.svg}" />

        <lrpViews:LinearGradientBoxView Grid.Row="1"
                                        EndColor="AliceBlue"
                                        StartColor="LightSkyBlue" />
        <ListView x:Name="AthletesListView"
                    Grid.Row="2"
                    RowHeight="-1"
                    HasUnevenRows="True"
                    SeparatorVisibility="None"
                    ItemsSource="{Binding Source={x:Reference LoginPageRoot}, Path=AthletesViewWrappers}">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <controls:ResizableViewCell>
                        <controls:AthleteLoginControlView Athlete="{Binding Athlete}"
                                                          BackgroundColor="{Binding BackgroundColor}"
                                                          Expanded="{Binding IsExpanded}"
                                                          Password="{Binding EnteredPassword}"
                                                          Command="{Binding Source={x:Reference LoginPageRoot},
                                                                            Path=ViewModel.LoginAthleteCommand}"
                                                          CommandParameter="{Binding EnteredPassword}">
                            <controls:AthleteLoginControlView.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding Source={x:Reference LoginPageRoot},
                                                                        Path=ViewModel.SelectAthleteCommand}"
                                                      CommandParameter="{Binding Athlete}" />
                            </controls:AthleteLoginControlView.GestureRecognizers>
                        </controls:AthleteLoginControlView>
                    </controls:ResizableViewCell>
                </DataTemplate>
            </ListView.ItemTemplate>
        
            <ListView.Effects>
                <effects:NoSelectionListViewEffect />
            </ListView.Effects>
        </ListView>
        <lrpViews:LinearGradientBoxView Grid.Row="3"
                                        StartColor="AliceBlue"
                                        EndColor="LightSkyBlue" />
        <controls:BorderButtonView Grid.Row="4"
                                    Margin="20"
                                    Text="{lrpForms:LocalizedText SignUp}"
                                    BorderWidth="4"
                                    Clicked="SignupButtonClicked"
                                    Command="{Binding GoToSignupCommand}" />
    </Grid>
</mvx:MvxContentPage>